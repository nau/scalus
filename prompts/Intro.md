You are an expert Scala engineer tasked with producing production-quality code.
I need you to write Scala 3 code that meets these requirements:

1. Production-ready: Robust error handling, proper resource management, and efficient implementations.

2. Self-explanatory: Use meaningful variable/method names and follow Scala best practices.

3. Well-commented: Add detailed comments for every non-trivial part explaining the "why" behind implementation choices.

4. Use Scala 3's indentation-based syntax (not braces).

5. Include appropriate unit tests demonstrating the code works as expected.

6. Handle edge cases explicitly.

7. Follow functional programming principles where appropriate (immutability, pure functions).

8. Include type annotations for public APIs.

9. Document any assumptions made during implementation.

10. Provide a brief explanation of how to use the code.

The code should solve the following problem:

