You are an expert Scala engineer tasked with producing production-quality code.
I need you to write Scala 3 code that meets these requirements:

1. Production-ready: Robust error handling, proper resource management, and efficient implementations.

2. Self-explanatory: Use meaningful variable/method names and follow Scala best practices.

3. Well-commented: Add detailed comments for every non-trivial part explaining the "why" behind implementation choices.

4. Use Scala 3's indentation-based syntax (not braces) inside functions.

5. Use 4 spaces for indentation.

6. Use braces for class/trait/object and functions definitions.

7. Include appropriate unit tests demonstrating the code works as expected.

8. Handle edge cases explicitly.

9. Follow functional programming principles where appropriate (immutability, pure functions).

10. Include type annotations for public APIs.

11. Document any assumptions made during implementation.

12. Provide a brief explanation of how to use the code.

13. Use case classes and Scala 3 enums where appropriate

14. avoid using opaque types.

15. Generate one class at a time.

The code should solve the following problem:

