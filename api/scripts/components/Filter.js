class Filter{constructor(e,t,s,i=!1){this._init=i,this._value=e,this._elementsRefs=s,this._filters=this._init?this._withNewFilters():t}static get defaultFilters(){return scaladocData.filterDefaults}get value(){return this._value}get filters(){return this._filters}get elementsRefs(){return this._elementsRefs}onFilterToggle(e,t){return new Filter(this.value,this._withToggledFilter(e,t),this.elementsRefs)}onGroupSelectionChange(e,t){return new Filter(this.value,this._withNewSelectionOfGroup(e,t),this.elementsRefs)}onInputValueChange(e){return new Filter(e,this._generateFiltersOnTyping(e),this.elementsRefs)}_generateFiltersOnTyping(e){const t=e.toLowerCase(),s=this.elementsRefs.filter((e=>{const s=getElementTextContent(getElementNameRef(e)).toLowerCase(),i=getElementTextContent(getElementDescription(e)).toLowerCase();return s.includes(t)||i.includes(t)})).map((e=>this._getDatasetWithKeywordData(e.dataset))).reduce(((e,t)=>(t.forEach((([t,s])=>{this._splitByComma(s).forEach((s=>{e[t]={...e[t],[s]:{...e[t][s],visible:!0}}}))})),e)),this._allFiltersAreHidden());return this._attachDefaultFilters(s)}_allFiltersAreHidden(){return Object.entries(this.filters).reduce(((e,[t,s])=>(e[t]=Object.keys(s).reduce(((e,t)=>(e[t]={...s[t],visible:!1},e)),{}),e)),{})}_withNewSelectionOfGroup(e,t){return{...this.filters,[e]:Object.keys(this.filters[e]).reduce(((s,i)=>(s[i]={...this.filters[e][i],...this.filters[e][i].visible&&{selected:t}},s)),{})}}_withNewFilters(){const e=this._elementsRefs.reduce(((e,t)=>(this._getDatasetWithKeywordData(t.dataset).forEach((([t,s])=>this._splitByComma(s).forEach((s=>{e[t]=e[t]?{...e[t],[s]:e[t][s]??new FilterItem}:{[s]:new FilterItem}})))),e)),{});return this._attachDefaultFilters(e)}_attachDefaultFilters(e){return Object.entries(Filter.defaultFilters).reduce(((e,[t,s])=>{const i=getFilterKey(t);return this._elementsRefs.some((e=>!!e.dataset[i]))?{...e,[i]:{...e[i],[s]:new FilterItem}}:e}),e)}_withToggledFilter(e,t){return{...this.filters,[e]:{...this.filters[e],[t]:{...this.filters[e][t],selected:!this.filters[e][t].selected}}}}_splitByComma=e=>e.split(",");_getDatasetWithKeywordData=e=>Object.entries(e).filter((([e])=>isFilterData(e)))}class FilterItem{constructor(e=!1,t=!0){this.selected=e,this.visible=t}}